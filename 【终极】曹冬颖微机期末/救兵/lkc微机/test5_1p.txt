OP	EQU	04H;阶梯数
OP2	EQU	02H;周期数

STACK	SEGMENT
		DW 128 DUP()
STACK	ENDS

CODE	SEGMENT
	ASSUME	CS:CODE
START:	MOV		CX,OP2
BO1:	MOV		DX,0600H;锯齿,0600跟IOY0对应
		MOV		AL,00H
SHU1:	OUT		DX,AL
		;输出波形
		CALL	DELAY1
		INC		AL
		CMP		AL,0FFH
		JNE		SHU1
		LOOP	BO1

		MOV		CX,OP2
BO2:	MOV		AX,0FFH;阶梯
		MOV		BL,OP
		DIV		BL
		MOV		BL,AL
		MOV		BH,0FFH
		SUB		BH,AH
		MOV		DX,0600H
		MOV		AL,00H
SHU2:	OUT		DX,AL
		;输出波形
		CALL	DELAY
		ADD		AL,BL
		CMP		AL,BH
		JNE		SHU2
		LOOP	BO2
		
		MOV		CX,OP2
BO3:	MOV		DX,0600H;矩形
		MOV		AL,00H
		OUT		DX,AL
		;输出波形
		CALL	DELAY2
		MOV		AL,0FFH
		OUT		DX,AL
		;输出波形
		CALL	DELAY2
		LOOP	BO3
		
		MOV		CX,OP2
BO4:	MOV		DX,0600H;三角
		MOV		AL,00H
SHU3:	OUT		DX,AL
		;输出波形
		CALL	DELAY1
		INC		AL
		CMP		AL,0FFH
		JNE		SHU3
		DEC		AL
TBO3:	OUT		DX,AL
		CALL	DELAY1
		;输出波形
		DEC		AL
		CMP		AL,0H
		JNE		TBO3
		LOOP	BO4
		
		JMP		START
		INT		03H;退出
		
DELAY	PROC
		PUSH	CX
		PUSH	BX
		MOV 	CX,50H
L2: 	MOV 	BX,0F00H
L1: 	DEC 	BX
		JNZ 	L1
		LOOP 	L2
		POP 	BX
		POP 	CX
		RET
DELAY	ENDP
DELAY1	PROC
		PUSH	CX
		PUSH	BX
		MOV 	CX,04F0H
LLL2:	NOP
		LOOP 	LLL2
		POP 	BX
		POP 	CX
		RET
DELAY1	ENDP
DELAY2	PROC
		PUSH	CX
		PUSH	BX
		MOV 	CX,50H
LL2:	MOV 	BX,0F00H
LL1:	DEC 	BX
		JNZ 	LL1
		LOOP 	LL2
		POP 	BX
		POP 	CX
		RET
DELAY2	ENDP
CODE	ENDS
	END		START
